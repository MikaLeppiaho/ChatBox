(this.webpackJsonpchatboxfront=this.webpackJsonpchatboxfront||[]).push([[0],{42:function(e,t,n){e.exports=n(98)},94:function(e,t){},97:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(40),s=n.n(c),u=n(2),o=n.n(u),l=n(4),i=n(5),p=function(e){var t=e.message;return r.a.createElement("div",{style:{color:"#543257",fontStyle:"italic",fontSize:16,listStyleType:"none",margin:10,padding:10,backgroundColor:"#aabb97",boxShadow:"0 4px 4px",textAlign:"left"}},r.a.createElement("li",null,t.username," ",t.date.slice(11,16),r.a.createElement("p",{style:{color:"#e8f1f7"}},t.content)))},f=n(7),m=n.n(f),g=null,d={getAllMessages:function(){return m.a.get("/api/messages").then((function(e){return e.data}))},createMessage:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,m.a.post("/api/messages",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){g="bearer ".concat(e)}},v={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=n(41),h=n.n(b),E=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=(t[0],t[1]),c=Object(a.useState)([]),s=Object(i.a)(c,2),u=s[0],f=s[1],m=Object(a.useState)(""),g=Object(i.a)(m,2),b=g[0],E=g[1],w=Object(a.useState)(""),x=Object(i.a)(w,2),O=x[0],j=x[1],S=Object(a.useState)(""),y=Object(i.a)(S,2),k=y[0],C=y[1],M=Object(a.useState)(null),A=Object(i.a)(M,2),T=A[0],D=A[1],J=h()();Object(a.useEffect)((function(){d.getAllMessages().then((function(e){f(e)})),J.on("message",function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getAllMessages();case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedChatBoxUser");if(e){var t=JSON.parse(e);D(t),d.setToken(t.token)}}),[]);var U=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={content:b,id:u.length+1,date:new Date(Date.now()).toString(),username:T.username},e.next=4,d.createMessage(n);case 4:return e.next=6,d.getAllMessages();case 6:a=e.sent,f(a),E(""),J.emit("chatMessage",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){E(e.target.value)},I=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v.login({username:O,password:k});case 4:a=e.sent,window.localStorage.setItem("loggedChatBoxUser",JSON.stringify(a)),d.setToken(a.token),D(a),j(""),C(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n("Wrong credentials");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{class:"grid-container"},r.a.createElement("div",{class:"grid-item"},r.a.createElement("h1",null," Chatbox ",null!==T&&r.a.createElement("form",{onSubmit:U},r.a.createElement("input",{value:b,onChange:B}),r.a.createElement("button",{type:"submit"},"Send")))),null===T&&r.a.createElement("form",{onSubmit:I},r.a.createElement("p",null,"Login to participate in the chat!"),r.a.createElement("p",null,r.a.createElement("strong",null,"Tip! "),"Username: demo & password: salasana"),r.a.createElement("div",null,"username:",r.a.createElement("input",{value:O,name:"Username",onChange:function(e){var t=e.target;return j(t.value)}})),r.a.createElement("div",null,"password:",r.a.createElement("input",{value:k,name:"Password",type:"password",onChange:function(e){var t=e.target;return C(t.value)}})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"login"))),r.a.createElement("div",{class:"grid-item"},r.a.createElement("ul",null,u.map((function(e){return r.a.createElement(p,{key:e.id,message:e})})))))};n(97);s.a.render(r.a.createElement(E,null),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.70d99969.chunk.js.map